對於一個區間 $[i, j]$ 的最大得分，我們記為 $dp[i, j]$。根據題目，每次取數字都必須從區間的開頭或結尾取數，也就是說 $dp[i, j]$ 與 $dp[i, j-1]$、 $dp[i+1, j]$ 之間有著必然的關聯，轉移方程必定從這裡入手。

假設與 $dp[i, j-1]$ 有關的狀態更優。那麼，我們先考慮 $dp[i, j]$ 與 $dp[i, j-1]$ 的關係。

我們可以清楚地知道， $dp[i, j]$ 在區間 $[i, j]$ 上取數的最大值，一共是 $(j-i-1)$ 個數。而 $dp[i, j-1]$ 在區間 $[i, j-1]$ 上取數的最大值，一共是 $(j-i-2)$ 個數。

按照我們之前的假設，與 $dp[i, j-1]$ 的狀態更優。那麼，對於區間 $[i, j]$ 的得分，顯然是先取第 $j$ 個數，再對後面的區間 $[i, j-1]$ 取最大得分。
(大的要放在後面取)

那麼，取第 $j$ 個數的得分為 $map[j] \times 2^1$。

取後面的區間 $[i, j-1]$ 的最大得分為 $\left(\sum_{k=1}^{j-i+2} data[c_{k+i-1}] \times 2^{k+1}\right) \max$，其中 $c_k$ 是區間 $[i, j-1]$ 中的數，且互不相同。

根據定義，我們又可以知道 $dp[i, j-1] = \left(\sum_{k=1}^{j-i+2} map[c_{k+i-1}] \times 2^k\right) \max$。

因此，聯立上面的式子，得出如果 $dp[i, j-1]$ 的狀態更優，那麼 $dp[i, j] = dp[i, j-1] \times 2 + map[j] \times 2 = 2(dp[i, j-1] + map[j])$。

同理，可以得出，如果 $dp[i+1, j]$ 的狀態更優，那麼，同樣有 $dp[i, j] = 2(dp[i+1, j] + map[i])$。

因此，可以歸納出狀態轉移方程：

$dp[i, j] = 2 \times \max(dp[i, j-1] + \text{map}[j], dp[i+1, j] + \text{map}[i])$



